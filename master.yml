# A master file that hold a configuration variables that being use by
# https://github.com/rynldtbuen/cumulus-vxconfig script to deploy Cumulus EVPN VXLAN in Symmetric Routing

############# VLANS #############
# Define a tenant in VLAN which is require in Cumulus EVPN VXLAN deployment
# The script will Automatically generate a L3VNI per tenant

# Examples:
# Automatically generate a CIDR with a prefix length of 20 for VLAN 500
# - id: '500'
#   name: 'vlan500'
#   prefixlen: 20
# Statically assign a CIDR for VLAN 501
# - id: '501'
#   name: 'vlan501'
#   network_prefix: 10.0.0.0/24
# Automatically generate a CIDR with a default prefix length for 24 for VLAN 502
# - id: '502'
#   name: 'vlan503'
# Allow source NAT for VLAN 501
# - id: '503'
#   name: 'vlan503'
#   allow_nat: true
vlans:
    tenant01:
      - id: '500'
        name: 'vlan500'
        prefixlen: 20
        allow_nat: true
      - id: '501'
        name: 'vlan501'

############# MLAG #############
# Define a peerlink interfaces require by MLAG.
# The interfaces will be the same in all switch (leaf or top-of-rack where servers is attach) in MLAG pair
# As of now it's not possible to define a different peerlink interfaces per switch or per MLAG pair
mlag_peerlink_interfaces: 'swp23-24'

# Define a bond facing a dual-connected server. Switch leaf01 and leaf02 is a MLAG pair named 'rack01' and so on.
# Bond members(slaves) will be the same on per MLAG pair.
# Examples:
# Configure leaf01 and leaf02 a bond named control01 with a bond slaves of swp1 and bond-mode as trunk
#   rack01:
#     - name: 'control01'
#       members: 'swp1'
#       vids: '500-501'
# Configure leaf03 and leaf04 a bond named control02 with a bond slaves of swp10 and bond-mode as access
#   rack02:
#     - name: 'control02'
#       members: 'swp10'
#       vids: '500'
# Documentation: https://docs.cumulusnetworks.com/display/DOCS/Multi-Chassis+Link+Aggregation+-+MLAG
mlag_bonds:
    rack01:
      - name: 'control01'
        members: 'swp1'
        vids: '500-501'
    rack02:
      - name: 'compute01'
        members: 'swp1'
        vids: '500-501'
    rack03:
      - name: 'compute02'
        members: 'swp2'
        vids: '500-501'

############# TOPOLOGY LINKS #############
# Define a point-to-point links between devices
network_links:
    fabric:
        links:
          - 'spine:swp1 -- leaf:swp21'
          - 'spine:swp23 -- border:swp23'
        interface_type: unnumbered
    external_connectivity:
        links:
          - 'edge:eth0 -- border:swp1'
        interface_type: sub_interface

############# BASE NETWORKS ###############
# loopbacks: Use to automatically generate loopback IP of the device. The host IP is determine by the device node ID.
#            Example given the loopback base network of group spine, spine01 will have an IP of 192.168.0.1/32.
#            Variable mapping, "name_of_ansible_group": "network/prefix"
# vxlan_anycast: Use to automatically generate a VTEP IP address in VXLAN active-active deployments.
#                Documentation: https://docs.cumulusnetworks.com/display/DOCS/VXLAN+Active-Active+Mode.
# vlans: Use to automatically generate a VLAN CIDR if 'network/prefix' or 'prefixlen' attribute is not defined in 'vlans' variables.
# external_connectivity: Use to dynamically generate point-to-point network /30 prefix, typically between border and edge device.
base_networks:
  loopbacks:
      spine: '192.168.0.0/25'
      edge: '192.168.0.128/25'
      border: '192.168.1.0/24'
      leaf: '192.168.2.0/23'
  vxlan_anycast: '192.168.8.0/23'
  vlans: '172.16.0.0/14'
  external_connectivity: '192.168.254.0/23'
  oob_management: '172.24.0.0/24'

############# BASE BGP AS #############
# The script is build to automatically generate a BGP AS in tier 2 CLOS topology. Not tested in multi-pod or tier 3 topology
# The BGP AS number is determine by the device node ID except for spine which will have the same BGP AS number per device.
# Example given the base BGP AS number of group leaf, leaf01 will have a BGP AS number of 64580
# Variable mapping, "name_of_ansible_group": "base_private_asn"
base_asn:
  spine: 64512
  edge: 64530
  border: 64550
  leaf: 64580

############# STATIC INTERFACES #############
# Define a static interfaces
ip_interfaces:
    edge01:
      - name: 'eth3'
        ip_address: 'dhcp'
        ip_nat: 'outside'
        alias: 'internet'
      - name: 'eth2' # Management interface
        ip_address: '172.24.0.254/24'
        alias: 'oob-management-gateway'

############# OUT-OF-BAND MANAGEMENT #############
domain: 'cumulusvxgns3.lab'
dhcp_range: '172.24.0.50,172.24.0.200'
gateway_address: '172.24.0.254'
dns_server: '172.24.0.10'
dns_forwarder: '8.8.8.8'
